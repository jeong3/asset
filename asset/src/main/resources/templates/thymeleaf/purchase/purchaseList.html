<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Purchase List</title>

<script type="text/javascript">
function detail(purchaseNum){
    window.open("/delivery/deliveryRegist?purchaseNum=" + purchaseNum, "",
        "width=800,height=800,top=100,left=100");
}
</script>

<style>
    body {
        font-family: 'Arial', sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f9;
    }

    table {
        width: 80%;
        margin: 30px auto;
        border-collapse: collapse;
        background-color: #ffffff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    th, td {
        padding: 15px;
        text-align: center;
        border: 1px solid #ddd;
    }

    th {
        background-color: #f2f2f2;
    }

    td {
        background-color: #ffffff;
    }

    .product-info {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .product-info img {
        width: 50px;
        height: 50px;
        margin-right: 10px;
    }

    a {
        text-decoration: none;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        table {
            width: 95%;
        }
        th, td {
            font-size: 14px;
        }
    }
</style>
</head>
<body>
<table>
    <tr>
        <th>주문일(결제번호)</th>
        <th>상품명/주문번호</th>
        <th>주문상태</th>
    </tr>
    <tr th:each="orderListDTO : ${list}">
        <td>
            [[${#dates.format(orderListDTO.purchaseDTO.purchaseDate,'yyyy-MM-dd')}]]
            (
            <span th:if="${orderListDTO.paymentDTO.appldate == null}">결제대기중</span>
            <span th:if="${orderListDTO.paymentDTO.appldate != null}">
                <span th:if="${orderListDTO.paymentDTO.confirmnumber == null}">현금결제</span>
                <span th:if="${orderListDTO.paymentDTO.confirmnumber != null}">
                    [[${orderListDTO.paymentDTO.confirmnumber}]]
                </span>
            </span>
            )
        </td>
        <td>
            <th:block th:each="purchaseListGoodsDTO : ${orderListDTO.purchaseListGoodsDTOs}">
                <div class="product-info">
                    <img th:src="|/static/images/${purchaseListGoodsDTO.goodsDTO.mainStoreImage}|" />
                    [[${purchaseListGoodsDTO.goodsDTO.goodsName}]]/[[${orderListDTO.purchaseDTO.purchaseNum}]]
                </div>
            </th:block>
        </td>
        <td>
            <a th:href="|javascript:detail('${orderListDTO.purchaseDTO.purchaseNum}');|">주문상세보기</a> |
            <span th:if="${orderListDTO.paymentDTO.appldate == null}">
                결제대기중
            </span>
            <th:block th:if="${orderListDTO.paymentDTO.appldate != null}">
                <span th:if="${orderListDTO.deliveryDTO.deliveryNum == null}">
                    결제완료
                </span>
                <th:block th:if="${orderListDTO.deliveryDTO.deliveryNum != null}">
                    <span th:if="${orderListDTO.deliveryDTO.deliveryStatus != '배송완료'}">
                        <a th:href="|/delivery/deliveryStatus?purchaseNum=${orderListDTO.purchaseDTO.purchaseNum}|">배송중</a>
                    </span>
                    <span th:if="${orderListDTO.deliveryDTO.deliveryStatus == '배송완료'}">
                        배송완료
                    </span>
                </th:block>
            </th:block>
        </td>
    </tr>
</table>
</body>
</html>
